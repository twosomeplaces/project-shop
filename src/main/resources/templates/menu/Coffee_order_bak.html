<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <title>Menu</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <head th:replace="~{fragments/header :: header}"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
    <!--JQuery-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <!--iamport.payment.js-->
    <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
    <script th:src="@{/js/payment.js}"></script>
</head>
<body>

<div id="main" style="font-size: large; text-align: center;">

    <h3>[ Coffee menu Management <span style="font-size:30px;">&#9749;</span> ]</h3>
    <table class="table">
        <thead>
        <tr>
            <th scope="col">메뉴명</th>
            <th scope="col">가격</th>
            <th scope="col">수량</th>
            <th scope="col">합계</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td th:text="${menuname}"></td>
            <td th:text="${menuprice}"></td>
            <td><input type="number" min="1" value="1" onchange="updateTotal()"></td>
            <td><input type="text" value="" readonly></td>
        </tr>
        <tr>
            <td colspan="4">
                <button id="payment" type="button" class="btn btn-primary" onclick="paymentCof">결제</button>
                <button id="cancel" type="button" class="btn btn-primary">취소</button>
            </td>
        </tr>
        </tbody>
    </table>
    <script>
        function updateTotal() {
            const menuPrice = parseFloat(document.querySelector('tr td:nth-child(2)').innerText);
            const quantity = parseFloat(document.querySelector('tr td:nth-child(3) input').value);
            const totalPrice = menuPrice * quantity;
            const formattedTotalPrice = totalPrice.toFixed(2).replace(/\.00$/, ''); // .00 삭제
            document.querySelector('tr td:nth-child(4) input').innerText = formattedTotalPrice;
        }
        // 페이지 로드시 한번 호출하여 초기화
        window.onload = updateTotal;


    document.getElementById('cancel').addEventListener('click', function() {
        history.back();
    });
    </script>
</div>
<div th:replace="~{fragments/footer :: footer}"/>
</body>
</html>